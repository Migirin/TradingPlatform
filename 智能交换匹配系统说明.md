# 智能商品交换匹配系统

## 功能简介

实现了智能商品交换匹配系统，让用户可以通过"以物易物"的方式进行交易，减少现金依赖，增加交易方式。

## 核心功能

### 1. 愿望清单管理
- **添加愿望**：用户可以添加想买的商品信息
  - 商品名称（必填）
  - 商品类别（可选）
  - 价格区间（可选：最低价格、最高价格）
  - 详细描述（可选）

- **管理愿望清单**：查看、删除已添加的愿望

### 2. 智能匹配算法
系统会根据以下因素进行匹配：

- **标题关键词匹配**（40分）
  - 分析愿望清单和商品标题的相似度
  - 使用关键词匹配算法

- **描述匹配**（20分）
  - 比较愿望清单描述和商品描述的相似度

- **价格匹配**（30分）
  - 检查商品价格是否在愿望清单的价格区间内
  - 计算价格接近度

- **类别匹配**（10分）
  - 如果指定了类别，检查商品是否属于该类别

**匹配分数范围**：0-100分，只显示分数大于30的匹配结果

### 3. 双向匹配
- **正向匹配**：我的愿望清单 vs 其他用户的商品
- **反向匹配**：其他用户的愿望清单 vs 我的商品

### 4. 匹配结果展示
- 显示匹配分数（0-100%）
- 展示匹配原因（高度匹配、价格合适、商品类型相似等）
- 显示可交换的商品信息
- 点击可查看商品详情

## 使用流程

### 1. 添加愿望清单
1. 在商品列表页点击"愿望清单"按钮
2. 点击"添加愿望"
3. 填写商品信息（至少填写商品名称）
4. 保存

### 2. 查找匹配
1. 在愿望清单页面点击"查找匹配"
2. 系统自动分析并显示匹配结果
3. 按匹配分数从高到低排序

### 3. 查看匹配结果
1. 查看匹配分数和原因
2. 点击匹配项查看商品详情
3. 联系卖家进行交换

## 数据库结构

### 愿望清单表（wishlist）
- `id`: 主键
- `user_id`: 用户ID
- `user_email`: 用户邮箱
- `title`: 商品名称
- `category`: 商品类别（可选）
- `min_price`: 最低价格（0表示不限制）
- `max_price`: 最高价格（0表示不限制）
- `description`: 详细描述
- `created_at`: 创建时间
- `updated_at`: 更新时间

## 技术实现

### 数据层
- `WishlistItem`: 愿望清单数据模型
- `WishlistEntity`: Room数据库实体
- `WishlistDao`: 数据访问对象
- `WishlistRepository`: 业务逻辑层，包含匹配算法

### UI层
- `WishlistScreen`: 愿望清单管理界面
- `AddWishScreen`: 添加愿望界面
- `ExchangeMatchesScreen`: 匹配结果展示界面
- `WishlistViewModel`: 状态管理

### 匹配算法
- `calculateMatchScore()`: 计算匹配分数
- `calculateTextSimilarity()`: 文本相似度计算
- `calculatePriceMatch()`: 价格匹配计算
- `getMatchReasons()`: 生成匹配原因

## 界面入口

1. **商品列表页**：点击"愿望清单"按钮
2. **商品详情页**：点击"交换匹配"按钮
3. **愿望清单页**：点击"查找匹配"按钮

## 注意事项

1. **数据库版本**：已升级到版本5，会自动重建数据库（开发阶段）
2. **匹配阈值**：只显示匹配分数大于30的结果
3. **双向匹配**：系统会同时匹配"我想买的"和"别人想买的"
4. **本地优先**：匹配算法使用本地数据库数据，网络恢复后会自动同步

## 未来优化方向

1. 添加商品类别标签系统
2. 支持多商品组合交换
3. 添加用户评价和信任度系统
4. 实现更智能的推荐算法（基于历史交易）
5. 添加交换成功后的确认机制




