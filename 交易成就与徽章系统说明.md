# 交易成就与徽章系统

## 功能简介

实现了完整的交易成就与徽章系统，通过游戏化元素增加用户粘性和趣味性。用户可以通过完成各种交易行为解锁成就，获得徽章奖励。

## 成就类型

### 1. 发布商品类成就
- **🎯 首次发布**：发布第一个商品
- **📦 小卖家**：发布5个商品
- **🏪 活跃卖家**：发布10个商品
- **🏬 资深卖家**：发布20个商品

### 2. 消息交流类成就
- **💬 初次交流**：发送第一条消息
- **📱 社交达人**：发送10条消息
- **📞 沟通专家**：发送50条消息

### 3. 愿望清单类成就
- **⭐ 愿望清单**：添加第一个愿望清单
- **✨ 愿望收集者**：添加5个愿望清单
- **🌟 梦想家**：添加10个愿望清单

### 4. 交换匹配类成就
- **🔄 首次交换**：完成第一次交换匹配
- **🔄🔄 交换达人**：完成5次交换匹配
- **🔄🔄🔄 交换大师**：完成10次交换匹配

### 5. 价格提醒类成就
- **💰 价格猎人**：设置第一个降价提醒
- **💎 捡漏王**：降价提醒成功触发

### 6. 商品故事类成就
- **📖 故事讲述者**：为商品添加故事
- **📚 情感卖家**：为5个商品添加故事

### 7. 其他成就
- **🏷️ 分类专家**：使用至少5个不同的商品类别
- **🐦 早起鸟**：在应用发布后7天内注册（待实现）
- **👑 忠实用户**：连续使用30天（待实现）

## 功能特点

### 1. 自动检测
- 在关键操作后自动检查成就：
  - 发布商品后
  - 发送消息后
  - 添加愿望清单后
- 应用启动时自动检查一次

### 2. 进度跟踪
- 对于需要多步完成的成就，显示当前进度
- 进度条可视化展示完成度
- 例如：3/5 表示已完成3个，还需要2个

### 3. 成就展示
- **统计卡片**：显示已解锁成就数量/总成就数量
- **进度条**：可视化展示整体完成度
- **成就列表**：展示所有成就（已解锁和未解锁）
- **图标展示**：每个成就都有独特的emoji图标

### 4. 解锁通知
- 成就解锁时自动发送通知
- 通知包含成就名称和描述
- 点击通知跳转到成就页面

## 数据库结构

### 用户成就表（user_achievements）
- `id`: 主键
- `user_id`: 用户ID
- `achievement_type`: 成就类型ID
- `unlocked_at`: 解锁时间
- `progress`: 当前进度
- `target`: 目标值

## 技术实现

### 数据层
- `AchievementType`: 成就类型枚举（定义所有成就）
- `UserAchievement`: 用户成就数据模型
- `UserAchievementEntity`: Room数据库实体
- `UserAchievementDao`: 数据访问对象
- `AchievementRepository`: 业务逻辑层，包含成就检测逻辑

### UI层
- `AchievementScreen`: 成就展示界面
- `AchievementCard`: 成就卡片组件
- `AchievementViewModel`: 状态管理

### 通知服务
- `AchievementNotificationService`: 成就解锁通知服务

## 使用方式

### 查看成就
1. **从商品列表页**：点击"我的成就"按钮
2. **从愿望清单页**：点击"我的成就"按钮
3. **直接导航**：通过路由 `Routes.ACHIEVEMENTS` 访问

### 解锁成就
成就会在以下操作后自动检测和授予：
- 发布商品
- 发送消息
- 添加愿望清单
- 应用启动时（检查所有成就）

### 查看进度
- 在成就页面可以看到每个成就的进度
- 已解锁的成就会高亮显示
- 未解锁的成就显示为灰色

## 界面设计

### 成就统计卡片
- 显示已解锁/总成就数量
- 进度条显示整体完成度
- 使用主题色突出显示

### 成就卡片
- **已解锁**：
  - 渐变背景图标
  - 高亮显示
  - 显示"已解锁"标签
- **未解锁**：
  - 灰色图标
  - 显示当前进度
  - 显示进度条

## 注意事项

1. **数据库版本**：已升级到版本8，会自动重建数据库（开发阶段）
2. **成就检测**：目前是操作后检测，不是实时监控
3. **消息统计**：需要从ChatMessageDao获取消息数量
4. **交换统计**：目前为0，需要添加交换记录表来跟踪

## 未来优化方向

1. 添加交换记录表，跟踪交换次数
2. 实现"早起鸟"和"忠实用户"成就（需要跟踪注册时间和使用天数）
3. 添加成就分享功能
4. 添加成就排行榜
5. 添加特殊成就（隐藏成就）
6. 添加成就奖励系统（积分、优惠券等）


